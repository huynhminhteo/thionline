var table_noti,table_noti_element=".table-noti";$((function(){"use strict";loadTableNoti(),$(document).on("click","#btnView",(function(){var t=$("#form_add_noti");if(t.parsley().validate(),t.parsley().isValid()){var n=$("#form_add_noti #title_noti").val(),e=$("#form_add_noti #content_noti").val();refreshModalSend(),$("#modal_send #noti_date").html(moment().format("YYYY年MM月DD日")),$("#modal_send #noti_title").html(n),$("#modal_send #noti_content").html(e.replace(/\r?\n|\r/g,"</br>")),$("#modal_send .block-button").removeClass("d-none"),$("#modal_send").modal("show")}})),$(document).on("click","#btnClear",(function(){$("#modal_send").modal("hide")})),$(document).on("click","#table_noti tbody tr",(function(){if($(this).data("id")){var t=$(this).find(".noti-date").html(),n=$(this).find(".noti-title").html(),e=$(this).find(".noti-content").html();refreshModalSend(),$("#modal_send #noti_date").html(moment(t).format("YYYY年MM月DD日")),$("#modal_send #noti_title").html(n),$("#modal_send #noti_content").html(e.replace(/\r?\n|\r/g,"</br>")),$("#modal_send").modal("show")}})),$(document).on("click","#btnSend",(function(){var t=$("#form_add_noti").serialize();$("#form_add_noti").parsley().isValid()&&(run_waitMe(".wait-containter"),$.ajax({url:base_api+"/notification/add/v1?token="+_token,type:"POST",data:t,success:function(t){Swal.fire({text:t.msg}).then((function(){$("#title_noti").val(""),$("#content_noti").val(""),$("#modal_send").modal("hide"),$(".slim-body .slim-mainpanel .container").removeClass("d-block"),loadTableNoti()})),run_waitMe(".wait-containter",!0)},error:function(t){run_waitMe(".wait-containter",!0),Swal.fire({text:t.responseJSON.msg})}}))})),$("#title_noti").keydown((function(t){if(13==t.keyCode)return t.preventDefault(),!1}))}));var loadTableNoti=function(){run_waitMe(".wait-containter"),$.fn.DataTable.isDataTable(table_noti_element)&&($(table_noti_element).DataTable().destroy(),$(".table-user tbody").empty());var t=base_api+"/notification/v1?token="+_token;table_noti=$(table_noti_element).DataTable({scrollY:"60vh",scrollCollapse:!0,stateSave:!0,autoWidth:!1,processing:!0,ajax:t,searching:!1,bSort:!1,bLengthChange:!1,bInfo:!1,bFilter:!1,bPaginate:!1,language:{emptyTable:"テーブル内のデータなし",zeroRecords:"一致する検索結果がありません"},columns:[{data:"date_create",render:function(t,n,e){return moment(t).format("YYYY/M/D")}},{data:"title"},{data:"content"}],columnDefs:[{targets:[0],class:"text-center multi-line noti-date wd-10p"},{targets:[1],class:"multi-line noti-title wd-30p"},{targets:[2],class:" noti-content"}],initComplete:function(t,n){$(".slim-body .slim-mainpanel .container").addClass("d-block"),run_waitMe(".wait-containter",!0)},fnCreatedRow:function(t,n,e){$(t).attr("data-id",n.id),$(t).attr("data-name",n.name),$(t).attr("data-role",n.role),$(t).attr("data-mail",n.mail)}}).on("processing.dt",(function(t,n,e){e?run_waitMe(".wait-containter"):($(".slim-body .slim-mainpanel .container").addClass("d-block"),run_waitMe(".wait-containter",!0))})),$(".dataTables_scrollHead").hide()},refreshModalSend=function(){$("#modal_send #noti_date").html(""),$("#modal_send #noti_title").html(""),$("#modal_send #noti_content").html(""),$("#modal_send .block-button").addClass("d-none")};